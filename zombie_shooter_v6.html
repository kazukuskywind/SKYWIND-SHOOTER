<!DOCTYPE html>
<html>
<head>
  <title>Skywind Zombie Shooter V6</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; background-color: #808080; }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// Fullscreen
function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

// Player
let player = {size:20, speed:4, health:100, gun:'pistol', ammo:Infinity};
player.x = canvas.width/2;
player.y = canvas.height/2;

// Game state
let gameState = 'menu'; // 'menu','playing','paused'

// Keys & Mouse
let keys = {};
document.addEventListener('keydown', e=>keys[e.key]=true);
document.addEventListener('keyup', e=>keys[e.key]=false);
let mouse = {x:0,y:0};
canvas.addEventListener('mousemove', e=>{
  const rect = canvas.getBoundingClientRect();
  mouse.x = e.clientX - rect.left;
  mouse.y = e.clientY - rect.top;
});

// Click handling
canvas.addEventListener('click', e=>{
  const rect = canvas.getBoundingClientRect();
  const mouseX = e.clientX - rect.left;
  const mouseY = e.clientY - rect.top;

  if(gameState==='menu'){
    if(mouseX>=canvas.width/2-100 && mouseX<=canvas.width/2+100 &&
       mouseY>=canvas.height/2-30 && mouseY<=canvas.height/2+30){
      gameState='playing'; spawnWave(5);
    }
  }

  if(gameState==='paused'){
    if(mouseX>=canvas.width/2-100 && mouseX<=canvas.width/2+100 &&
       mouseY>=canvas.height/2 && mouseY<=canvas.height/2+60){
      gameState='playing';
    }
  }

  if(gameState==='playing'){
    shoot();
  }

  // Pause button
  if(gameState==='playing'){
    if(mouseX>=canvas.width-110 && mouseX<=canvas.width-10 &&
       mouseY>=10 && mouseY<=50){
      gameState='paused';
    }
  }
});

// Bullets
let bullets = [];

// Guns
const guns = {
  pistol: {damage:10,speed:8,rate:300},
  shotgun: {damage:20,speed:6,rate:700,spread:5},
  rifle: {damage:15,speed:12,rate:150},
  laser: {damage:25,speed:15,rate:200}
};
let lastShot = 0;

// Wave guns
const waveGuns=['pistol','shotgun','rifle','laser'];

// Zombies
const zombieTypes=[
  {type:'normal', speed:1, health:30, color:'green'},
  {type:'fast', speed:2, health:20, color:'lime'},
  {type:'tank', speed:0.5, health:60, color:'darkgreen'}
];
let zombies=[];
let wave=1;
let score=0;

// Power-ups
let powerUps=[];

// Blood splatter
let bloods=[];

// Shoot
function shoot(){
  const now = Date.now();
  const gun = guns[player.gun];
  if(now-lastShot<gun.rate || player.ammo<=0) return;
  lastShot = now;
  if(player.ammo!==Infinity) player.ammo--;

  const angle = Math.atan2(mouse.y-player.y, mouse.x-player.x);
  if(player.gun==='shotgun'){
    for(let i=-2;i<=2;i++){
      const spreadAngle = angle + i*0.1;
      bullets.push({x:player.x,y:player.y,dx:Math.cos(spreadAngle)*gun.speed,dy:Math.sin(spreadAngle)*gun.speed,damage:gun.damage});
    }
  } else bullets.push({x:player.x,y:player.y,dx:Math.cos(angle)*gun.speed,dy:Math.sin(angle)*gun.speed,damage:gun.damage});
}

// Spawn wave
function spawnWave(number){
  zombies=[];
  // Auto gun upgrade
  const gunIndex=(wave-1)%waveGuns.length;
  player.gun = waveGuns[gunIndex];
  player.ammo = Infinity; // For now unlimited
  for(let i=0;i<number;i++){
    const type=zombieTypes[Math.floor(Math.random()*zombieTypes.length)];
    const side=Math.floor(Math.random()*4);
    let x,y;
    if(side===0){x=0;y=Math.random()*canvas.height;}
    else if(side===1){x=canvas.width;y=Math.random()*canvas.height;}
    else if(side===2){x=Math.random()*canvas.width;y=0;}
    else{x=Math.random()*canvas.width;y=canvas.height;}
    zombies.push({x,y,size:20,speed:type.speed,health:type.health,color:type.color});
  }
}

// Spawn power-up
function spawnPowerUp(){
  const types=['health','ammo'];
  const type=types[Math.floor(Math.random()*types.length)];
  const x=Math.random()*canvas.width;
  const y=Math.random()*canvas.height;
  powerUps.push({x,y,type,size:15});
}

// Update
function update(){
  if(gameState!=='playing') return;

  // World movement
  let dx=0, dy=0;
  if(keys['w']||keys['ArrowUp']) dy=player.speed;
  if(keys['s']||keys['ArrowDown']) dy=-player.speed;
  if(keys['a']||keys['ArrowLeft']) dx=player.speed;
  if(keys['d']||keys['ArrowRight']) dx=-player.speed;

  zombies.forEach(z=>{z.x+=dx; z.y+=dy;});
  bullets.forEach(b=>{b.x+=dx; b.y+=dy;});
  powerUps.forEach(p=>{p.x+=dx; p.y+=dy;});

  // Bullets
  bullets.forEach((b,i)=>{
    b.x+=b.dx; b.y+=b.dy;
    if(b.x<0||b.x>canvas.width||b.y<0||b.y>canvas.height) bullets.splice(i,1);
  });

  // Zombies move
  zombies.forEach((z,zi)=>{
    const angle=Math.atan2(player.y-z.y,player.x-z.x);
    z.x+=Math.cos(angle)*z.speed;
    z.y+=Math.sin(angle)*z.speed;

    // Collision with player
    const dxp=player.x-z.x, dyp=player.y-z.y;
    if(Math.sqrt(dxp*dxp+dyp*dyp)<player.size+z.size){
      player.health-=1;
      if(player.health<=0) alert("Game Over! Score: "+score) & location.reload();
    }

    // Bullet collision
    bullets.forEach((b,bi)=>{
      const dx=b.x-z.x, dy=b.y-z.y;
      if(Math.sqrt(dx*dx+dy*dy)<z.size){
        z.health-=b.damage;
        bullets.splice(bi,1);
        // Spawn blood
        for(let i=0;i<10;i++){
          const angle = Math.random()*Math.PI*2;
          const speed = Math.random()*3;
          bloods.push({x:z.x,y:z.y,dx:Math.cos(angle)*speed,dy:Math.sin(angle)*speed,life:30});
        }
        if(z.health<=0){zombies.splice(zi,1); score+=10;}
      }
    });
  });

  // Collect power-ups
  powerUps.forEach((p,i)=>{
    const dx=player.x-p.x, dy=player.y-p.y;
    if(Math.sqrt(dx*dx+dy*dy)<player.size+p.size){
      if(p.type==='health') player.health=Math.min(player.health+30,100);
      if(p.type==='ammo') player.ammo = Infinity;
      powerUps.splice(i,1);
    }
  });

  // Blood update
  bloods.forEach((b,i)=>{
    b.x+=b.dx; b.y+=b.dy; b.life--;
    if(b.life<=0) bloods.splice(i,1);
  });

  // Spawn random power-up
  if(Math.random()<0.002) spawnPowerUp();

  // Wave complete
  if(zombies.length===0){
    wave++;
    spawnWave(5+wave*2);
  }
}

// Draw
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Menu
  if(gameState==='menu'){
    ctx.fillStyle='#808080';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle='white';
    ctx.font='60px Arial';
    ctx.textAlign='center';
    ctx.fillText('Skywind Zombie Shooter',canvas.width/2,canvas.height/4);
    ctx.font='40px Arial';
    ctx.fillText('Play',canvas.width/2,canvas.height/2);
    ctx.fillText('KazukuBongot',canvas.width/2,canvas.height/2+90);
    return;
  }

  // Paused
  if(gameState==='paused'){
    ctx.fillStyle='rgba(0,0,0,0.7)';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle='white';
    ctx.font='50px Arial';
    ctx.textAlign='center';
    ctx.fillText('Paused',canvas.width/2,canvas.height/2-50);
    ctx.fillStyle='gray';
    ctx.fillRect(canvas.width/2-100,canvas.height/2,200,60);
    ctx.fillStyle='white';
    ctx.font='30px Arial';
    ctx.fillText('Resume',canvas.width/2,canvas.height/2+40);
    return;
  }

  // Player
  ctx.fillStyle='blue';
  ctx.beginPath();
  ctx.arc(player.x,player.y,player.size,0,Math.PI*2);
  ctx.fill();

  // Bullets
  bullets.forEach(b=>{
    ctx.fillStyle='yellow';
    ctx.beginPath();
    ctx.arc(b.x,b.y,5,0,Math.PI*2);
    ctx.fill();
  });

  // Zombies
  zombies.forEach(z=>{
    ctx.fillStyle=z.color;
    ctx.beginPath();
    ctx.arc(z.x,z.y,z.size,0,Math.PI*2);
    ctx.fill();
  });

  // Power-ups
  powerUps.forEach(p=>{
    ctx.fillStyle = p.type==='health'?'pink':'cyan';
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
    ctx.fill();
  });

  // Blood
  bloods.forEach(b=>{
    ctx.fillStyle='red';
    ctx.beginPath();
    ctx.arc(b.x,b.y,2,0,Math.PI*2);
    ctx.fill();
  });

  // HUD
  ctx.fillStyle='white';
  ctx.font='20px Arial';
  ctx.fillText('Health: '+player.health,10,30);
  ctx.fillText('Score: '+score,10,60);
  ctx.fillText('Gun: '+player.gun,10,90);
  ctx.fillText('Wave: '+wave,10,120);
  ctx.fillText('Ammo: '+(player.ammo===Infinity?'âˆž':player.ammo),10,150);
}

// Pause button
function drawPauseButton(){
  ctx.fillStyle='red';
  ctx.fillRect(canvas.width-110,10,100,40);
  ctx.fillStyle='white';
  ctx.font='20px Arial';
  ctx.fillText('Pause',canvas.width-60,35);
}

// Game loop
function gameLoop(){
  update();
  draw();
  if(gameState==='playing') drawPauseButton();
  requestAnimationFrame(gameLoop);
}
gameLoop();
</script>
</body>
</html>
